---
title: "Replication Report"
author: "Hannah Hardenbergh"
date: "3/13/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# This is replication code for "Physiological Arousal and Political Beliefs"
# published in Political Psychology by authors Jonathan Renshon, Julia Lee &
# Dustin Tingley.

# Initial read -- this dataset contains several variables that are poorly named,
# slightly confusing as to what they refer to such as "anxcond" and "anxcond3",
# and I already know that the stata document is going to give me a headache.
# Here goes!

# We will replicate Figures 2, 3, and Table 1 from the published paper.
```

```{r}
# Table 1

# in the author's stata code, when they type "reg SCDBradSelfReport1_mean
# anxcond if anxcond3 ~= 0", I believe that tells stata to make a linear
# regression to show SCD mean scores during the video when "Anxiety Condition"
# is equal to 0 -- (anxcond = Anxiety Manipulation Dummy, just for reference.
# they are not the same.) from the handy-dandy stata manuals webpage, I learned
# this formula for linear regressions in stata: "regress [depvar] [indepvars] if
# [in] [weight] , options." So, I will use lm() to run the same regression in r.
# set an "option" for anxcond3 == 0 on the RHS of model formula.

fig2.out <- lm(data = anxiety, 
               SCDBradSelfReport1_mean ~ anxcond3 == 0)
summary(fig2.out)


```



```{r}
#Figure 2: Means of Skin Conductance Reactivity by Video Condition, ciplot
#"SCDBradVidManipAll_mean" which means SCD mean score of the subject during the
#video they watched), by anxcond3, which means Anxiety Manipulation Dummy.



```


```{r}
# Figure 3

# Load Data
anxiety<-read.csv("renshon_files/anxiety.csv") 

## Make Subsets (do this last)
noRelaxCond <- subset(anxiety, anxcond3>0)

#Outcome Model
y <- lm(immigration ~ anxcond + SCDBradSelfReport1_mean+storycond, data= noRelaxCond)
summary(y) # summarize results from model

#Mediator Model
m <- lm(SCDBradSelfReport1_mean ~ anxcond+storycond, data= noRelaxCond)
summary(m) # summarize results from model

# Mediation Analysis
m.out <-  mediate(m, y,
               sims = 500,
               treat = "anxcond", 
               mediator = "SCDBradSelfReport1_mean", 
               dropobs = TRUE, 
               boot = TRUE, 
               conf.level = .90)
summary(m.out)

m.out %>% 
  ggplot(aes(m.out)) + geom_boxplot() %>% 
  labs(y = c("ACME\n(Physiological \nReactivity)", "Direct Effect \n(Anxiety)", "Total Effect"),
       x = "Skin Conductance Reactivity",
       caption = "Figure 2. Means of skin-conductance reactivity by video condition. 95% confidence intervals are in blue (online version).")

```

