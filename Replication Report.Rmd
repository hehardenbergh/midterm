---
title: "Replication Report"
author: "Hannah Hardenbergh"
date: "3/13/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# code for Figure 3: Causal Mediation Plot

# Load Data
anxiety<-read.csv("renshon_files/anxiety.csv") 

## Make Subsets (do this last)
noRelaxCond <- subset(anxiety, anxcond3>0)

#Outcome Model
y <- lm(immigration ~ anxcond + SCDBradSelfReport1_mean+storycond, data= noRelaxCond)
summary(y) # summarize results from model

#Mediator Model
m <- lm(SCDBradSelfReport1_mean ~ anxcond+storycond, data= noRelaxCond)
summary(m) # summarize results from model

# Mediation Analysis
m.out <-  mediate(m, y,
               sims = 500,
               treat = "anxcond", 
               mediator = "SCDBradSelfReport1_mean", 
               dropobs = TRUE, 
               boot = TRUE, 
               conf.level = .90)
summary(m.out)
plot(m.out, labels=c("ACME\n(Physiological \nReactivity)", "Direct Effect \n(Anxiety)", "Total Effect"))

```

